<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="com.shmashine.api.dao.BizRoleDao">
    <resultMap type="com.shmashine.common.entity.TblSysRole" id="TblSysRoleResultMap">
        <result property="vRoleId" column="v_role_id" jdbcType="VARCHAR"/>
        <result property="vRoleName" column="v_role_name" jdbcType="VARCHAR"/>
        <result property="vRoleSign" column="v_role_sign" jdbcType="VARCHAR"/>
        <result property="vRemark" column="v_remark" jdbcType="VARCHAR"/>
        <result property="dtCreatetime" column="dt_createTime" jdbcType="TIMESTAMP"/>
        <result property="dtModifytime" column="dt_modifyTime" jdbcType="TIMESTAMP"/>
        <result property="bLoginVerifyPhone" column="b_login_verify_phone" jdbcType="BIT"/>
        <result property="vCreateid" column="v_createid" jdbcType="VARCHAR"/>
        <result property="vModifyid" column="v_modifyid" jdbcType="VARCHAR"/>
    </resultMap>

    <sql id="table_field">
        v_role_id
        , v_role_name, v_role_sign, v_remark, b_login_verify_phone, dt_createTime, dt_modifyTime, v_createid, v_modifyid
    </sql>

    <!-- 获取角色列表 -->
    <select id="searchRoleList" resultType="com.shmashine.common.entity.TblSysRole">
        select
        <include refid="table_field"/>
        from tbl_sys_role
        <where>
            <if test="searchRoleListModule.vRoleId != null and searchRoleListModule.vRoleId != ''">
                and v_role_id like CONCAT('%',#{searchRoleListModule.vRoleId,jdbcType=VARCHAR},'%')
            </if>
            <if test="searchRoleListModule.vRoleName != null and searchRoleListModule.vRoleName != ''">
                and v_role_name like CONCAT('%',#{searchRoleListModule.vRoleName,jdbcType=VARCHAR},'%')
            </if>
        </where>
    </select>

    <!-- 获取角色详情 -->
    <select id="getRoleDetail" resultType="com.shmashine.common.entity.TblSysRole">
        select
        v_role_id,
        v_role_name,
        v_remark,
        b_login_verify_phone
        from tbl_sys_role
        <where>
            v_role_id = #{roleId,jdbcType=VARCHAR}
        </where>
    </select>

    <select id="searchByRoleIds" resultType="com.shmashine.common.entity.TblSysRole">
        select
        <include refid="table_field"/>
        from tbl_sys_role WHERE
        <foreach collection="roleIds" index="index" item="roleId" open="(" close=")" separator="or">
            ( `v_role_id`=#{roleId} )
        </foreach>
    </select>

</mapper>